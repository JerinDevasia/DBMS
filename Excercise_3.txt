create database ques3;
use ques3;
CREATE TABLE branch(branch_name varchar(25),branch_city varchar(25),assets varchar(25),PRIMARY KEY(branch_name));
CREATE TABLE customer(customer_name varchar(25),customer_street varchar(25),customer_city varchar(25),PRIMARY KEY(customer_name));
CREATE TABLE loan(loan_number int,branch_name varchar(25),amount int,PRIMARY KEY(loan_number));
CREATE TABLE borrower(customer_name varchar(25),loan_number int);
CREATE TABLE account(account_number int,branch_name varchar(25),balance int,PRIMARY KEY(account_number));
CREATE TABLE depositors(customer_name varchar(25),account_name varchar(25),PRIMARY KEY(account_name));
ALTER TABLE loan ADD FOREIGN KEY(branch_name) REFERENCES branch(branch_name);
ALTER TABLE borrower ADD FOREIGN KEY(customer_name) REFERENCES customer(customer_name);
ALTER TABLE borrower ADD FOREIGN KEY(loan_number) REFERENCES loan(loan_number);
ALTER TABLE account ADD FOREIGN KEY(branch_name) REFERENCES branch(branch_name);
ALTER TABLE depositors ADD FOREIGN KEY(customer_name) REFERENCES customer(customer_name);
ALTER TABLE depositors CHANGE COLUMN account_name account_number int;
ALTER TABLE depositors ADD FOREIGN KEY(account_number) REFERENCES account(account_number);
INSERT into branch VALUES('downtown','LA','fixed'),('MG Road','Chennai','fixed'),('Newtown','Hyderabad','fixed');
INSERT into branch VALUES('Mahim','Mumbai','fixed'),('New Delhi Main','Delhi','fixed');
INSERT INTO customer VALUES('Smith','Fashion Street','Mumbai'),('Henry','Fashion Street','Mumbai'),('Rio','Ash Court','Harrison'),('Ruby','Broadway','New York');
INSERT INTO loan VALUES(55456,'downtown',50000),(55567,'Mahim',75000),(55432,'MG Road',45000),(55789,'Newtown',25000),(55678,'New Delhi Main',0);
INSERT INTO borrower VALUES('Henry',55432),('Rio',55456),('Ruby',55678),('Smith',55567);
INSERT INTO account VALUES(20385678,'downtown',20000),(2087639,'Mahim',25000),(2087641,'New Delhi Main',30000);
INSERT INTO depositors VALUES('Henry',20385678),('Rio',2087639),('Smith',2087641);
SELECT c.customer_name FROM customer c INNER JOIN borrower b INNER JOIN loan l ON b.customer_name=c.customer_name AND l.loan_number=b.loan_number WHERE amount=0;
SELECT customer_name FROM customer WHERE customer_street='Fashion Street' AND customer_city='Mumbai';
SELECT c.customer_name,a.branch_name from customer c INNER JOIN depositors d INNER JOIN account a on a.account_number=d.account_number AND c.customer_name=d.customer_name WHERE customer_city='Harrison';